---
import Layout from "../layouts/Layout.astro";
import { getCollection } from 'astro:content';

import Section from "../components/Section.astro";
const assets = await getCollection('assets');
const galleryDict = {};
assets.forEach(item => {
    const galleryName = item.id.split('/')[1];

    if (!galleryDict[galleryName]) {
        galleryDict[galleryName] = [];
    }

    galleryDict[galleryName].push(item.data.url);
});

const sections = Object.entries(galleryDict).map(([name, assets]) => ({
    name,
    assets
}))

---
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
<Layout title="SOP8 - Galerie">
    <Section title="Galerie">
        {sections.map(({ name, assets }) => (
            <div class="section">
                <h2 class="sectionTitle">{ name }</h2>
                <div class="gallery">
                    <!-- @ts-ignore -->
                    {assets.map((asset) => (
                        <a class="glightbox" href={asset}>
                            <img class="img" src={asset} alt={asset} />
                        </a>
                    ))}
                </div>
            </div>
        ))}
    </Section>
</Layout>
<style>
    .section {
        + .section {
            margin-top: 60px;
        }
    }

    .sectionTitle {
        margin-bottom: 20px;
    }

    .gallery {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 4px;
        width: 100%;
    }

    .img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>
<script type="module">
    import 'https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js';

    GLightbox({
        zoomable: false,
    })
</script>